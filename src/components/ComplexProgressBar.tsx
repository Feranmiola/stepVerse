import React from "react";

interface ComplexProgressBarProps {
  current: number;
  goal: number;
}

export const ComplexProgressBar: React.FC<ComplexProgressBarProps> = ({ current, goal }) => {
  const percentage = Math.min((current / goal) * 100, 100);
  const totalPaths = svgPaths.length;
  const filledPaths = Math.floor((percentage / 100) * totalPaths);

  // Sort paths based on their position in the speedometer
  const sortedPaths = [...svgPaths].sort((a, b) => {
    const aCoords = getPathCoordinates(a);
    const bCoords = getPathCoordinates(b);
    return compareCoordinates(aCoords, bCoords);
  });

  return (
    <svg width="196.12" height="160.76" viewBox="0 0 254 209" fill="none" xmlns="http://www.w3.org/2000/svg">
      {sortedPaths.map((path, index) => (
        <path
          key={index}
          d={path}
          fill={index < filledPaths ? "#007CFF" : "#DCDCDC"}
        />
      ))}
    </svg>
  );
};

// Helper function to get the start and end coordinates of a path
const getPathCoordinates = (path: string): { start: number[], end: number[] } => {
  const coordinates = path.match(/[-]?\d*\.?\d+/g)?.map(Number) || [];
  const midIndex = Math.floor(coordinates.length / 2);
  return {
    start: [coordinates[0], coordinates[1]],
    end: [coordinates[midIndex], coordinates[midIndex + 1]]
  };
};

// Helper function to compare coordinates based on their position in the speedometer
const compareCoordinates = (a: { start: number[], end: number[] }, b: { start: number[], end: number[] }): number => {
  const centerX = 127; // Approximate center X of the SVG
  const centerY = 104.5; // Approximate center Y of the SVG
  const startAngle = Math.PI * 0.73; // Start from bottom left (3/4 * PI radians)

  const angleA = (Math.atan2(a.start[1] - centerY, a.start[0] - centerX) - startAngle + 2 * Math.PI) % (2 * Math.PI);
  const angleB = (Math.atan2(b.start[1] - centerY, b.start[0] - centerX) - startAngle + 2 * Math.PI) % (2 * Math.PI);

  return angleA - angleB;
};

export default ComplexProgressBar;

const svgPaths = [
    "M116.007 15.7221L116.591 15.6666L115.208 1.14746L114.625 1.20288L116.007 15.7221Z",
    "M121.284 15.3401L121.867 15.3139L121.179 0.748047C120.987 0.748047 120.791 0.748047 120.596 0.774297L121.284 15.3401Z",
    "M110.752 16.3522L111.335 16.2705L109.294 1.83008L108.71 1.91174L110.752 16.3522Z",
    "M131.862 15.3139L132.446 15.3401L133.131 0.774297C132.939 0.774297 132.743 0.756797 132.548 0.748047L131.862 15.3139Z",
    "M167.941 22.9561L168.484 23.1719L173.854 9.60938L173.311 9.39062L167.941 22.9561Z",
    "M162.972 21.1356L163.523 21.3252L168.248 7.52354L167.708 7.32812L162.972 21.1356Z",
    "M147.621 17.1196L148.204 17.2276L150.937 2.90089L150.354 2.79297L147.621 17.1196Z",
    "M105.534 17.2276L106.117 17.1196L103.373 2.79297L102.79 2.89797L105.534 17.2276Z",
    "M137.142 15.6696L137.725 15.7221L139.096 1.20288L138.512 1.14746L137.142 15.6696Z",
    "M142.397 16.2705L142.981 16.3522L145.037 1.91174L144.454 1.83008L142.397 16.2705Z",
    "M66.4412 32.8284L66.9341 32.5163L59.1203 20.2021L58.6245 20.5142L66.4412 32.8284Z",
    "M62.0524 35.7831L62.5308 35.4507L54.1453 23.5186L53.667 23.8511L62.0524 35.7831Z",
    "M57.8082 38.9421L58.2691 38.5863L49.3295 27.0625C49.1749 27.1821 49.0203 27.2987 48.8687 27.4212L57.8082 38.9421Z",
    "M49.7845 45.8277L50.2075 45.4252L40.2237 34.7969L39.8008 35.1965L49.7845 45.8277Z",
    "M46.0221 49.5622L46.4275 49.1422L35.9538 38.9922L35.5513 39.4122L46.0221 49.5622Z",
    "M85.2456 23.1719L85.7881 22.9531L80.4185 9.39062L79.876 9.60646L85.2456 23.1719Z",
    "M90.2065 21.3281L90.7577 21.1386L86.0415 7.32812L85.4902 7.51771L90.2065 21.3281Z",
    "M80.3775 25.2481L80.9083 25.009L74.9058 11.7031L74.375 11.9452L80.3775 25.2481Z",
    "M95.2498 19.718L95.8098 19.5547L91.7265 5.55469L91.1665 5.71802L95.2498 19.718Z",
    "M157.92 19.5547L158.48 19.718L162.549 5.71802L161.989 5.55469L157.92 19.5547Z",
    "M232.459 89.1762C232.526 89.357 232.593 89.5408 232.657 89.7245L246.383 84.7837L246.185 84.2324L232.459 89.1762Z",
    "M228.375 79.4108C228.456 79.5858 228.541 79.7608 228.625 79.9387L241.823 73.7262L241.572 73.2012L228.375 79.4108Z",
    "M234.133 94.1898C234.191 94.3765 234.247 94.5632 234.302 94.7498L248.247 90.4536C248.188 90.2669 248.133 90.0802 248.074 89.8965L234.133 94.1898Z",
    "M225.983 74.6863C226.077 74.8555 226.17 75.0276 226.275 75.1997L239.167 68.3747C239.073 68.2026 238.98 68.0305 238.875 67.8584L225.983 74.6863Z",
    "M235.58 99.2826C235.629 99.4693 235.676 99.6589 235.725 99.8456L249.854 96.2201C249.804 96.0305 249.758 95.841 249.708 95.6543L235.58 99.2826Z",
    "M238.452 114.883C238.475 115.076 238.496 115.268 238.516 115.467L253.012 113.866L252.951 113.282L238.452 114.883Z",
    "M223.381 70.0782C223.483 70.2444 223.583 70.4107 223.673 70.5769L236.215 63.154L235.923 62.6523L223.381 70.0782Z",
    "M253.473 119.238L238.918 120.154L238.953 120.737L253.508 119.822L253.473 119.238Z",
    "M236.785 104.436C236.823 104.626 236.863 104.815 236.901 105.005L251.193 102.047C251.152 101.858 251.111 101.668 251.073 101.479L236.785 104.436Z",
    "M214.32 57.0579L214.684 57.5129L226.059 48.3954L225.695 47.9375L214.32 57.0579Z",
    "M186.792 32.5163L187.285 32.8284L195.102 20.5142L194.609 20.2021L186.792 32.5163Z",
    "M191.2 35.4506L191.675 35.7861L200.063 23.854L199.585 23.5186L191.2 35.4506Z",
    "M195.46 38.5863L195.921 38.945L204.861 27.4212L204.4 27.0625L195.46 38.5863Z",
    "M220.567 65.5942C220.675 65.7575 220.78 65.9208 220.888 66.0812L233.077 58.0779C232.972 57.9146 232.864 57.7542 232.756 57.5908L220.567 65.5942Z",
    "M182.257 29.7872L182.764 30.0789L189.989 17.4089L189.481 17.1172L182.257 29.7872Z",
    "M172.818 25.009L173.349 25.2481L179.352 11.954L178.821 11.7031L172.818 25.009Z",
    "M210.904 53.0175C211.032 53.1604 211.158 53.3092 211.286 53.455L222.226 43.8096L221.841 43.3721L210.904 53.0175Z",
    "M203.519 45.4399L203.945 45.8394L213.929 35.2082L213.5 34.8086L203.519 45.4399Z",
    "M207.299 49.1422L207.705 49.5622L218.167 39.4122L217.761 38.9922L207.299 49.1422Z",
    "M70.9658 30.0779C71.135 29.9788 71.3041 29.8854 71.4733 29.7863L64.2458 17.125L63.7383 17.4167L70.9658 30.0779Z",
    "M213.573 198.849C213.45 199 213.325 199.14 213.199 199.298L224.437 208.593C224.563 208.444 224.688 208.302 224.81 208.144L213.573 198.849Z",
    "M225.424 181.346C225.33 181.515 225.237 181.687 225.132 181.856L237.916 188.882L238.207 188.372L225.424 181.346Z",
    "M219.917 190.376L219.587 190.857L231.651 199.056L231.98 198.575L219.917 190.376Z",
    "M216.843 194.686C216.726 194.843 216.606 194.998 216.49 195.152L228.156 203.902L228.506 203.438L216.843 194.686Z",
    "M34.1454 190.857L33.8158 190.379L21.7554 198.575L22.085 199.056L34.1454 190.857Z",
    "M40.5414 199.298C40.416 199.149 40.2905 199.006 40.168 198.849L28.9155 208.147L29.2889 208.593L40.5414 199.298Z",
    "M28.5838 181.856C28.4905 181.687 28.3942 181.518 28.2921 181.346L15.5229 188.372C15.6163 188.544 15.7096 188.713 15.8146 188.882L28.5838 181.856Z",
    "M37.2374 195.163C37.1207 195.008 37.0011 194.854 36.8874 194.699L25.2207 203.449L25.5765 203.913L37.2374 195.163Z",
    "M239.135 125.454C239.135 125.647 239.135 125.842 239.135 126.037L253.718 125.81C253.718 125.614 253.718 125.422 253.718 125.227L239.135 125.454Z",
    "M227.853 176.644C227.768 176.819 227.684 176.994 227.596 177.169L240.698 183.585L240.952 183.06L227.853 176.644Z",
    "M42.4399 53.455C42.5683 53.3092 42.6937 53.1633 42.8249 53.0146L31.8845 43.3721L31.4995 43.8096L42.4399 53.455Z",
    "M239.109 130.732C239.109 130.925 239.109 131.12 239.089 131.316L253.672 131.774L253.69 131.19L239.109 130.732Z",
    "M26.1298 177.169C26.0423 176.994 25.9578 176.819 25.8732 176.646L12.7744 183.063C12.859 183.238 12.9436 183.41 13.0311 183.585L26.1298 177.169Z",
    "M237.547 146.518C237.515 146.71 237.483 146.9 237.448 147.101L251.819 149.609L251.915 149.026L237.547 146.518Z",
    "M230.061 171.828C229.982 172.006 229.906 172.187 229.831 172.365L243.215 178.157C243.294 177.979 243.37 177.799 243.446 177.621L230.061 171.828Z",
    "M236.542 151.703C236.502 151.893 236.458 152.082 236.414 152.286L250.65 155.469C250.691 155.279 250.735 155.089 250.779 154.9L236.542 151.703Z",
    "M232.036 166.926L231.832 167.471L245.476 172.628C245.546 172.444 245.613 172.263 245.68 172.08L232.036 166.926Z",
    "M235.279 156.852C235.23 157.041 235.174 157.228 235.125 157.414L249.195 161.264C249.244 161.075 249.3 160.888 249.349 160.702L235.279 156.852Z",
    "M238.315 141.283L238.245 141.867L252.715 143.695L252.785 143.112L238.315 141.283Z",
    "M19.4251 94.7469C19.4805 94.5632 19.5359 94.3765 19.5942 94.1899L5.65255 89.9023C5.59422 90.0861 5.5388 90.2728 5.48047 90.4594L19.4251 94.7469Z",
    "M25.1125 79.9358L25.3604 79.4108L12.1625 73.1982C12.0808 73.3762 11.9962 73.5512 11.9116 73.7262L25.1125 79.9358Z",
    "M21.0842 89.7245C21.1484 89.5408 21.2155 89.357 21.2826 89.1733L7.55673 84.2324C7.48965 84.4162 7.42548 84.5999 7.3584 84.7807L21.0842 89.7245Z",
    "M16.8263 105.004C16.8643 104.814 16.9051 104.625 16.943 104.435L2.65132 101.475C2.6134 101.667 2.57257 101.857 2.53174 102.058L16.8263 105.004Z",
    "M18.0014 99.8456C18.051 99.6589 18.0976 99.4693 18.1472 99.2826L4.01888 95.6543C3.9693 95.841 3.92263 96.0305 3.87305 96.2201L18.0014 99.8456Z",
    "M32.8387 66.0812L33.1595 65.5941L20.9707 57.5879C20.8628 57.7483 20.7549 57.9116 20.6499 58.075L32.8387 66.0812Z",
    "M27.4664 75.1997L27.7581 74.6834L14.8664 67.8584L14.5835 68.3747L27.4664 75.1997Z",
    "M39.042 57.5129L39.4066 57.055L28.0316 47.9375L27.667 48.3954L39.042 57.5129Z",
    "M30.0417 70.5769C30.1379 70.4107 30.24 70.2444 30.3333 70.0753L17.7917 62.6523L17.5 63.154L30.0417 70.5769Z",
    "M23.8987 172.371C23.8199 172.193 23.7441 172.012 23.6683 171.834L10.2808 177.626C10.3566 177.807 10.4324 177.985 10.5112 178.163L23.8987 172.371Z",
    "M18.602 157.414C18.5524 157.228 18.4999 157.041 18.4474 156.852L4.37451 160.702C4.42701 160.888 4.47951 161.075 4.5291 161.264L18.602 157.414Z",
    "M17.3192 152.286C17.2754 152.097 17.2317 151.907 17.1909 151.703L2.95459 154.894C2.99834 155.084 3.04209 155.273 3.08292 155.463L17.3192 152.286Z",
    "M21.8947 167.471C21.8277 167.29 21.7606 167.107 21.6906 166.926L8.04639 172.082C8.11347 172.263 8.18055 172.447 8.25055 172.628L21.8947 167.471Z",
    "M16.2777 147.092C16.2427 146.9 16.2106 146.71 16.1785 146.509L1.81104 149.017C1.84312 149.207 1.8752 149.399 1.9102 149.6L16.2777 147.092Z",
    "M14.7729 120.737L14.8079 120.154L0.25375 119.238L0.21875 119.822L14.7729 120.737Z",
    "M15.2107 115.464C15.2311 115.268 15.2515 115.076 15.2749 114.881L0.77901 113.279C0.755677 113.472 0.73526 113.667 0.714844 113.863L15.2107 115.464Z",
    "M14.5833 126.036C14.5833 125.844 14.5833 125.648 14.5833 125.453L0 125.223C0 125.418 0 125.611 0 125.806L14.5833 126.036Z",
    "M14.6389 131.313C14.6389 131.12 14.6389 130.925 14.6185 130.729L0.0351562 131.187L0.0526563 131.771L14.6389 131.313Z",
    "M15.4815 141.86L15.4115 141.276L0.941895 143.111L1.01189 143.694L15.4815 141.86Z",
    "M177.334 27.1627L178.372 27.6935L184.996 14.6968L183.955 14.166L177.334 27.1627Z",
    "M199.349 41.7445C199.64 41.9953 199.932 42.2462 200.224 42.5028L209.694 31.4195L208.819 30.6641L199.349 41.7445Z",
    "M217.371 61.0184C217.601 61.3305 217.829 61.6455 218.056 61.9605L229.857 53.3884C229.629 53.0734 229.399 52.7584 229.169 52.4463L217.371 61.0184Z",
    "M126.292 0.620117V15.2035H127.458V0.620117H126.292Z",
    "M238.858 135.727C238.829 136.114 238.797 136.502 238.765 136.893L253.304 138.039C253.336 137.652 253.368 137.264 253.395 136.873L238.858 135.727Z",
    "M252.102 107.078L237.708 109.35C237.773 109.735 237.834 110.117 237.892 110.502L252.292 108.221C252.225 107.836 252.164 107.454 252.102 107.078Z",
    "M230.417 83.9751C230.569 84.3338 230.709 84.6926 230.866 85.0513L244.341 79.4688C244.195 79.1111 244.047 78.7523 243.895 78.3926L230.417 83.9751Z",
    "M100.076 18.4111L101.208 18.1486L97.8069 3.96484L96.6724 4.23318L100.076 18.4111Z",
    "M152.516 18.1486L153.65 18.4169L157.057 4.23318L155.922 3.96484L152.516 18.1486Z",
    "M14.9625 136.887C14.9305 136.502 14.8984 136.114 14.8692 135.721L0.33252 136.87C0.35877 137.258 0.390853 137.646 0.422936 138.037L14.9625 136.887Z",
    "M20.2236 162.758C20.1011 162.39 19.9786 162.02 19.8619 161.649L5.9873 166.156C6.10689 166.529 6.22647 166.897 6.34897 167.267L20.2236 162.758Z",
    "M31.4125 186.67C31.2083 186.341 31.0042 186.008 30.8029 185.676L18.375 193.297C18.5763 193.63 18.7804 193.962 18.9846 194.292L31.4125 186.67Z",
    "M222.927 185.676L222.314 186.67L234.751 194.286L235.364 193.291L222.927 185.676Z",
    "M233.865 161.649C233.748 162.02 233.625 162.39 233.506 162.758L247.378 167.267C247.5 166.897 247.62 166.526 247.739 166.156L233.865 161.649Z",
    "M53.4914 42.4862C53.7831 42.2325 54.0748 41.9787 54.3664 41.7279L44.896 30.6445C44.6043 30.8954 44.3127 31.1491 44.021 31.4029L53.4914 42.4862Z",
    "M35.671 61.9605C35.8985 61.6455 36.126 61.3305 36.3564 61.0184L24.5585 52.4463C24.328 52.7584 24.1005 53.0734 23.873 53.3884L35.671 61.9605Z",
    "M75.3547 27.6906L76.3931 27.1627L69.7722 14.166L68.7339 14.6968L75.3547 27.6906Z",
    "M15.8493 110.502C15.9076 110.117 15.9689 109.735 16.033 109.35L1.62468 107.078C1.56343 107.463 1.50218 107.845 1.44385 108.23L15.8493 110.502Z",
    "M22.8695 85.0513C23.0183 84.6897 23.1612 84.3309 23.3187 83.9751L9.84078 78.3926C9.69203 78.7513 9.54911 79.1101 9.39453 79.4688L22.8695 85.0513Z"
];

